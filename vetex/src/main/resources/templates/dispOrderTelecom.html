<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" th:href="@{/css/styles.css}"/>
<link rel="shortcut icon" type="image/x-icon" th:href="@{/images/favicon.ico}">
<title>Корзина Заказа</title>
</head>
<body>
<div class="headerDispOrder">
<div id="header1">
<a th:href="@{/priceItems/telecom}" class="ref">На страницу ТЦП</a> &nbsp&nbsp | &nbsp&nbsp
<form th:action="@{/clearCart/telecom}" method="get" style="display:inline;">
<input type="submit" name="submit" value="Очистить корзину"> &nbsp&nbsp | &nbsp&nbsp
</form>
<form id="orderPage" th:action="@{/orders/createOrder}" method="get" style="display:inline;">
<input type="hidden" name="contractnumber" th:value="${contractnumber}">
<input type="hidden" name="contractdate" th:value="${contractdate}">
<input type="hidden" name="id" th:value="${id}">
<input type="submit" name="submit" value="Сохранить заявку в БД">
</form>
<!-- <form id="orderPage2" th:action="@{/orders/showAllOrders}" method="get" style="display:inline;">
<input type="hidden" name="contractnumber" th:value="${contractnumber}">
<input type="hidden" name="contractdate" th:value="${contractdate}">
<input type="submit" name="submit" value="БД Заявок"> &nbsp&nbsp | &nbsp&nbsp
</form> -->
</div>
<div id="header2">
<span th:text="'Пользователь: '+${userLogin} + ' | Роль: ' + ${userRole}" style="color:#800000;"></span>
</div>
</div>
<br>
<div class="smetaDispOrder">
<table class="listItems">
<tr>
<th class="col4"></th><th class="col2">№ пп</th><th>Наименование работ</th><th class="col4">Ед. изм.</th><th>Цена за ед., руб. без НДС</th><th class="col8">Кол-во</th>
<th class="col1">Стоимость</th>
</tr>
<tr th:each="order: ${cart}">
<td class="col4">
<form th:action="@{/deleteFromOrder/telecom}" method="get" style="display:inline;">
<input type="hidden" name="ppnumber" th:value="${order.getPpNumber}">
<input type="hidden" name="quantity" th:value="${order.getQuantity}">
<input type="submit" name="submit" value="Удалить">
</form>
</td>
<td th:text="${order.getPpNumber}" class="col2"></td><td th:text="${order.getWorkName}"></td><td th:text="${order.getUnitMeasure}" class="col4"></td>
<td th:text="${order.getPrice}"></td>
<td class="col8">
<form th:action="@{/saveQuantityChanges/telecom}" id="saveQuantity" method="get" style="display:inline;">
<input type="number" name="newQuantity" th:value="${order.getQuantity}" step="0.01" min="0.01" style="border:none;text-align:center;width:55px;"> &nbsp&nbsp | &nbsp&nbsp
<input type="hidden" name="ppnumber" th:value="${order.getPpNumber}">
<input type="hidden" name="quantity" th:value="${order.getQuantity}">
<input type="submit" name="submit" value="Изменить" style="display:inline;">
</form>
</td>
<td th:text="${order.getEndPrice}" class="col1"></td>
</tr>

<tr><td colspan="6" style="text-align:right">Итоговая стоимость работ без НДС, руб.</td><td th:text="${sumWithOutNds}"></td></tr>
<tr><td colspan="6" style="text-align:right">НДС % - по ставке в соответствии с законодательством, руб.</td><td th:text="${Nds}"></td></tr>
<tr><td colspan="6" style="text-align:right">Итоговая стоимость с НДС, руб.</td><td th:text="${sumWithNds}"></td></tr>
</table>
</div>
<br>

<div>
<fieldset name="order">
   <legend> Данные для создания Заявки </legend>
<div id="ordersshow1">
   <p style="display:inline;"><label for="ordernumber">№ Заявки: </label>
      <input form ="orderPage" type="number" id="ordernumber" name="ordernumber" th:value="*{ordernumber !=0} ? *{ordernumber} : '' "  min="1" required></p> &nbsp&nbsp ← | ← &nbsp&nbsp
      <form id="orderPage2" th:action="@{/orders/showNextOrderNumber}" method="get" style="display:inline;">
          <input type="hidden" name="contractnumber" th:value="${contractnumber}">
          <input type="hidden" name="contractdate" th:value="${contractdate}">
          <input type="submit" name="submit" value="Получить номер Заявки" class="ordnum">
          </form>
   <p><label for="bsnumber">№ Базовой стации: </label>
      <input form ="orderPage" type="text" id="bsnumber" name="bsnumber" th:value="*{bsnumber !=null} ? *{bsnumber} : '' " placeholder="78-XXXXX " pattern="78-\d{5}" required></p>
   <p><label for="send">Дата подачи заявки : </label>
      <input form ="orderPage" type="date" id="send" name="send" th:value="*{send !=null} ? *{send} : '' " required></p>
   <p><label for="start">Начало выполнения работ : </label>
      <input form ="orderPage" type="date" id="start" name="start" th:value="*{start !=null} ? *{start} : '' " required></p>
   <p><label for="end">Окончание выполнения работ : </label>
      <input form ="orderPage" type="date" id="end" name="end" th:value="*{endtime !=null} ? *{endtime} : '' " required></p>
   <p style="display:inline;"><label for="remedy">№ Инцидента/работы в Remedy: </label>
      <input form ="orderPage" type="text" id="remedy" name="remedy" th:value="*{remedy !=null} ? *{remedy} : '' " placeholder="MSK000010717602"  required></p> &nbsp&nbsp | &nbsp&nbsp <a href="http://remedy/arsys/shared/login.jsp" class="remedyhref" target="_blank" style="display:inline;"> Открыть Remedy </a>
   <p><label for="author">Инициатор заявки: ФИО(телефон): </label>
      <input form ="orderPage" type="text" id="author" name="author" th:value="*{author !=null} ? *{author} : ${username}" style="width:250px;" required></p>
   <p><label for="arenda">Контакт арендодателя: ФИО(телефон): </label>
      <input form ="orderPage" type="text" id="arenda" name="arenda" th:value="*{arenda !=null} ? *{arenda} : '' " style="width:300px;"></p>
   <p><label for="arenda">Вид работ: </label>
      <input form ="orderPage" type="text" id="worktype" name="worktype" th:value="*{worktype !=null} ? *{worktype} : '' " style="width:300px;" required></p>   
   <p><label for="comment">Комментарий: </label>
      <textarea form ="orderPage" id="comment" name="comment" cols="40" rows="5" wrap="hard" placeholder="Пояснение задачи для подрядчика(при необходимости)." th:text="*{comment !=null} ? *{comment} : '' "></textarea></p>
</div>
<div id="ordersshow2">
  <h3 th:text="${contractname}" style="color:#8B4513;"></h3>
</div>
</fieldset>
</div>

<br>
<fieldset name="order">
   <legend> Дополнительные данные (для редактирования статуса Заявки) </legend>
   <p><label for="status">Статус заявки : </label>
      <input form ="orderPage" type="text" id="status" name="status" th:value="*{status !=null} ? *{status} : '' " style="width:450px;"></p>
   <p><label for="orderlistcomment">Комментарии по статусу/проверке/приемке : </label>
      <input form ="orderPage" type="text" id="orderlistcomment" name="orderlistcomment" th:value="*{orderlistcomment !=null} ? *{orderlistcomment} : '' " style="width:450px;"></p>   
   <p><label for="report">Наличие ИД : </label>
      <input form ="orderPage" type="radio" id="report" name="report" th:value="да" th:checked="*{report =='да'}"> Да 
      <input form ="orderPage" type="radio" id="report" name="report" th:value="нет" th:checked="*{report =='нет'}"> Нет </p>
   <p><label for="cedr">Внесено в Кедр: </label>
      <input form ="orderPage" type="radio" id="cedr" name="cedr" th:value="да" th:checked="*{cedr=='да'}"> Да 
      <input form ="orderPage" type="radio" id="cedr" name="cedr" th:value="нет" th:checked="*{cedr=='нет'}"> Нет </p>
</fieldset>

<br><br><br><br>
<div th:replace="footer :: footer"></div>
</body>
</html>